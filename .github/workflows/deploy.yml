name: Deploy to SiteGround

 

on:

  push:

    branches:

      - main

      - master

  workflow_dispatch: # Permite ejecutar manualmente

 

jobs:

  deploy:

    name: Deploy to SiteGround via SFTP

    runs-on: ubuntu-latest

 

    steps:

      - name: Checkout code

        uses: actions/checkout@v4

        with:

          fetch-depth: 0

 

      - name: Setup Node.js (opcional para build)

        uses: actions/setup-node@v4

        with:

          node-version: '20'

 

      - name: Install dependencies (si usas npm/yarn)

        run: |

          if [ -f "package.json" ]; then

            if [ -f "package-lock.json" ]; then

              npm ci

            else

              npm install

            fi

          fi

 

      - name: Build project (si necesitas compilar)

        run: |

          if [ -f "package.json" ] && grep -q '"build"' package.json; then

            npm run build

          fi

 

      - name: Deploy to SiteGround via SFTP

        uses: SamKirkland/FTP-Deploy-Action@v4.3.5

        with:

          server: ${{ secrets.FTP_SERVER }}

          username: ${{ secrets.FTP_USERNAME }}

          password: ${{ secrets.FTP_PASSWORD }}

          port: ${{ secrets.FTP_PORT || 21 }}

          protocol: ftps

          local-dir: ./src/

          server-dir: /public_html/

          dangerous-clean-slate: false

          exclude: |

            **/.git*

            **/.git*/**

            **/node_modules/**

            **/.env

            **/composer.lock

            **/.DS_Store

            **/package.json

            **/package-lock.json

            **/vite.config.js
